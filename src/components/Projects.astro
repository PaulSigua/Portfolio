---
import Badge from "./icons/Badge.astro";
import medicalSysImage from "../assets/img/medical-system-img.png";
import dictsqlImage from "../assets/img/dictsql-img.png";
import { useTranslations } from "../i18n/utils";

interface Props {
  lang?: "en" | "es" | "ja";
}

const { lang = "en" } = Astro.props;
const t = useTranslations(lang);

const PROJECTS = [
  {
    titleKey: "projects.project1.title",
    image: medicalSysImage,
    link: "https://github.com/PaulSigua/Medical-System",
    badges: [
      { text: "AI", color: "black" },
      { text: "Angular", color: "red" },
      { text: "Tailwind CSS", color: "orange" },
      { text: "FastAPI", color: "green" },
    ],
    descriptionKey: "projects.project1.description",
    altKey: "projects.project1.alt",
  },
  {
    titleKey: "projects.project2.title",
    image: dictsqlImage,
    link: "https://github.com/PaulSigua/DictSQL",
    badges: [
      { text: "Angular", color: "red" },
      { text: "Python", color: "green" },
      { text: "Tailwind CSS", color: "purple" },
      { text: "FastAPI", color: "blue" },
    ],
    descriptionKey: "projects.project2.description",
    altKey: "projects.project2.alt",
  },
];
---

<div class="w-full max-w-5xl mx-auto ">
  <div class="pb-8">
    <h1 class="flex gap-3 text-2xl font-bold items-center text-app">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="40"
        height="40"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="p-2 rounded-lg bg-badge border border-app-soft text-[var(--primary)]"
      >
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <path d="M7 8l-4 4l4 4"></path>
        <path d="M17 8l4 4l-4 4"></path>
        <path d="M14 4l-4 16"></path>
      </svg>
      {t("projects.title")}
    </h1>
  </div>

  <div class="flex flex-col gap-10">
    {
      PROJECTS.map((project) => (
        <article
          class="group relative flex flex-col md:flex-row gap-6 p-4 rounded-2xl 
                      bg-badge border border-app-soft transition-all duration-300
                      hover:shadow-[var(--shadow)] hover:border-[var(--primary)]/30 hover:-translate-y-1"
        >
          <a
            href={project.link}
            target="_blank"
            class="absolute inset-0 z-0"
            aria-label={`Ver proyecto ${t(project.titleKey as any)}`}
          />

          <div class="w-full md:w-5/12 aspect-video overflow-hidden rounded-xl border border-app-soft relative z-10 pointer-events-none">
            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors z-10 duration-500" />

            <img
              class="w-full h-full object-cover object-top transition-transform duration-500 ease-in-out group-hover:scale-105"
              src={project.image.src}
              loading="lazy"
              alt={t(project.altKey as any)}
            />
          </div>

          <div class="w-full md:w-7/12 flex flex-col justify-between z-10 pointer-events-none">
            <div>
              <div class="flex flex-row justify-between items-start mb-3">
                <h2 class="text-xl font-bold text-app group-hover:text-[var(--primary)] transition-colors">
                  {t(project.titleKey as any)}
                </h2>

                <span class="p-2 rounded-full bg-[var(--surface-1)] text-muted group-hover:text-[var(--primary)] group-hover:bg-[var(--primary)]/10 transition-colors">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="size-5"
                    viewBox="0 0 24 24"
                    stroke-width="2"
                    stroke="currentColor"
                    fill="none"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6" />
                    <path d="M11 13l9 -9" />
                    <path d="M15 4h5v5" />
                  </svg>
                </span>
              </div>

              <div class="flex flex-wrap gap-2 mb-4">
                {project.badges.map((badge) => (
                  // Nota: Aseg√∫rate de usar 'Badge' con las mejoras que hicimos antes
                  <Badge color={badge.color}>{badge.text}</Badge>
                ))}
              </div>

              <p
                class="text-muted text-[15px] leading-relaxed mb-4"
                set:html={t(project.descriptionKey as any)}
              />
            </div>

            <div class="mt-auto pt-2 flex items-center gap-4">
              <span class="text-xs font-medium text-subtle flex items-center gap-1 group-hover:text-[var(--text-strong)] transition-colors">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="size-4"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <>
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
                  </>
                </svg>
                {t("projects.viewCode")}
              </span>
            </div>
          </div>
        </article>
      ))
    }
  </div>
</div>
